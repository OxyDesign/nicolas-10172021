(this["webpackJsonporder-book"]=this["webpackJsonporder-book"]||[]).push([[0],{19:function(t,e,n){},20:function(t,e,n){"use strict";n.r(e);var s=n(1),c=n.n(s),i=n(7),r=n.n(i),o=n(2),a=n(5),u=function(t,e){return JSON.stringify({event:t?"subscribe":"unsubscribe",feed:"book_ui_1",product_ids:["PI_".concat(e,"USD")]})},d=function(t){return t.sort((function(t,e){return t[0]-e[0]}))},b=function(t){var e=0;return t.map((function(t){return[].concat(Object(a.a)(t),[e+=t[1]])}))},l=function(t,e){for(var n=[],s=0,c=0;s<t.length&&c<e.length;){var i=t[s],r=e[c];r[0]<i[0]?(0!==r[1]&&n.push(r),c++):r[0]>i[0]?(n.push(i),s++):(0!==r[1]&&n.push(r),c++,s++)}return s<t.length?n.push.apply(n,Object(a.a)(t.slice(s))):c<e.length&&n.push.apply(n,Object(a.a)(e.slice(c).filter((function(t){return 0!==t[1]})))),n},j=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.toFixed(e).split("."),s=Object(o.a)(n,2),c=s[0],i=s[1],r=0;return c=c.split("").reduceRight((function(t,e){var n=e+(r&&r%3===0?",":"")+t;return r++,n}),""),e?[c,i].join("."):c},h=n(0);var f=function(t){var e=t.order,n=t.max,s=Object(o.a)(e,3),c=s[0],i=s[1],r=s[2],a=n?100*r/n:0;return Object(h.jsxs)("tr",{style:{backgroundSize:"".concat(a,"%")},children:[Object(h.jsx)("td",{className:"price",children:j(c,2)}),Object(h.jsx)("td",{children:j(i)}),Object(h.jsx)("td",{children:j(r)})]})};var v=function(t){var e=t.type,n=t.orders,s=n.length?n[n.length-1][2]:0;return Object(h.jsxs)("table",{className:"orders-table ".concat(e),children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Price"}),Object(h.jsx)("th",{children:"Size"}),Object(h.jsx)("th",{children:"Total"})]})}),Object(h.jsx)("tbody",{children:n.map((function(t,e){return Object(h.jsx)(f,{order:t,max:s},e)}))})]})};var O=function(t){var e=t.children,n=t.onClick,s=void 0===n?function(){}:n;return Object(h.jsx)("button",{className:"primary-button",onClick:function(){s()},children:e})},p=n(8),k=n(9),x=function t(e){var n=this,s=e.onConnect;Object(p.a)(this,t),this.url="wss://www.cryptofacilities.com/ws/v1",this.socket=void 0,this.onData=function(){},this.asks=void 0,this.bids=void 0,this.product=void 0,this.interval=0,this.close=function(){n.socket.close()},this.subscribe=function(t){var e=t.product,s=t.frequency,c=t.onData;n.product=e,n.onData=c,n.isConnected()&&(n.socket.send(u(!0,n.product)),n.interval=window.setInterval((function(){n.sendData()}),s))},this.unsubscribe=function(t){var e=t.product;n.asks=[],n.bids=[],n.product="",n.onData=function(){},n.interval&&clearInterval(n.interval),n.isConnected()&&n.socket.send(u(!1,e))},this.sendData=function(){n.onData&&n.onData({asks:n.asks.slice(),bids:n.bids.slice()})},this.isConnected=function(){return 1===n.socket.readyState},this.product="",this.asks=[],this.bids=[],this.socket=new k.w3cwebsocket(this.url),this.socket.onopen=function(){s()},this.socket.onmessage=function(t){var e=t.data,s=void 0===e?"":e,c=JSON.parse(s),i=c.event,r=void 0===i?"":i,o=c.feed,a=void 0===o?"":o,u=c.asks,b=void 0===u?[]:u,j=c.bids,h=void 0===j?[]:j;if("info"!==r&&"subscribed"!==r){var f=d(b),v=d(h);"book_ui_1_snapshot"===a?(n.asks=f,n.bids=v,n.sendData()):"book_ui_1"===a&&(f.length&&(n.asks=l(n.asks,f)),v.length&&(n.bids=l(n.bids,v)))}}};var m=function(){var t=Object(s.useState)(null),e=Object(o.a)(t,2),n=e[0],c=e[1],i=Object(s.useState)(!0),r=Object(o.a)(i,2),a=r[0],u=r[1],d=Object(s.useState)(!1),l=Object(o.a)(d,2),f=l[0],p=l[1],k=Object(s.useState)(""),m=Object(o.a)(k,2),g=m[0],w=m[1],N=Object(s.useState)({asks:[],bids:[]}),y=Object(o.a)(N,2),S=y[0],C=y[1],D=S.asks.length&&S.bids.length?Math.abs(S.asks[0][0]-S.bids[0][0]):0,T=D>0?100*D/S.asks[0][0]:0,_=f?"Paused":"Loading...",B=function(t,e){setTimeout((function(){return e(!1)}),200),t.subscribe({product:g,frequency:500,onData:function(t){var e=t.asks,n=t.bids;C({asks:b(e),bids:b(n.reverse())})}})},E=function(t,e){e(!0),t.unsubscribe({product:g})};Object(s.useEffect)((function(){var t=new x({onConnect:function(){w("XBT")}});c(t);var e=function(){return E(t,p)};return window.addEventListener("blur",e),function(){window.removeEventListener("blur",e),t.close()}}),[]),Object(s.useEffect)((function(){if(g&&n)return B(n,u),function(){E(n,u)}}),[g,n]);var F=Object(h.jsxs)("h2",{className:"ob-spread",children:["Spread:\xa0",Object(h.jsx)("span",{className:"number",children:j(D,1)}),"\xa0(",Object(h.jsx)("span",{className:"number",children:j(T,2)}),"%)"]});return Object(h.jsxs)("section",{className:"ob",children:[Object(h.jsxs)("div",{className:"ob-title-container",children:[Object(h.jsx)("h1",{className:"ob-title",children:"Order Book"}),F]}),Object(h.jsxs)("div",{className:"ob-tables-container",children:[Object(h.jsx)(v,{type:"ask",orders:S.asks}),F,Object(h.jsx)(v,{type:"bid",orders:S.bids})]}),Object(h.jsx)("div",{className:"ob-footer",children:Object(h.jsx)(O,{onClick:function(){w((function(t){return"XBT"===t?"ETH":"XBT"}))},children:"Toggle Feed"})}),Object(h.jsxs)("div",{className:"ob-loader ".concat(a||f?"visible":""),children:[Object(h.jsx)("span",{children:_}),f&&Object(h.jsx)(O,{onClick:function(){return B(n,p)},children:"Reconnect"})]})]})};n(18),n(19);var g=function(){return Object(h.jsx)("div",{className:"app",children:Object(h.jsx)(m,{})})},w=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,21)).then((function(e){var n=e.getCLS,s=e.getFID,c=e.getFCP,i=e.getLCP,r=e.getTTFB;n(t),s(t),c(t),i(t),r(t)}))};r.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(g,{})}),document.getElementById("root")),w()}},[[20,1,2]]]);
//# sourceMappingURL=main.c561d12e.chunk.js.map